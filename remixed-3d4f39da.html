<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumen5 ROI Calculator - Post-Production Savings</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}.container{max-width:1200px;margin:0 auto;background:rgba(255,255,255,.95);border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.1);overflow:hidden}.header{background:linear-gradient(135deg,#4f46e5 0%,#7c3aed 100%);color:#fff;padding:40px;text-align:center}.header h1{font-size:2.5rem;margin-bottom:10px;font-weight:700}.header p{font-size:1.1rem;opacity:.9}.main-content{display:grid;grid-template-columns:1fr 1fr;gap:0;min-height:600px}.input-section{padding:40px;background:#f8fafc;border-right:1px solid #e2e8f0;color:#374151}.results-section{padding:40px;background:#fff}.form-group{margin-bottom:25px}.form-group label{display:block;margin-bottom:8px;font-weight:600;color:#374151;font-size:.95rem}.form-group input,.form-group select{width:100%;padding:12px 16px;border:2px solid #e5e7eb;border-radius:12px;font-size:1rem;transition:all .3s ease;background:#fff;color:#1e293b}.form-group select:disabled{background:#f3f4f6;cursor:not-allowed;color:#374151}.form-group input:focus,.form-group select:focus{outline:0;border-color:#4f46e5;box-shadow:0 0 0 3px rgba(79,70,229,.1)}.form-group small{display:block;margin-top:5px;color:#6b7280;font-size:.85rem;line-height:1.4}.calculate-btn{width:100%;padding:16px;background:linear-gradient(135deg,#4f46e5 0%,#7c3aed 100%);color:#fff;border:none;border-radius:12px;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 15px rgba(79,70,229,.3)}.calculate-btn:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(79,70,229,.4)}.results-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:30px}.metric-card{background:linear-gradient(135deg,#f1f5f9 0%,#e2e8f0 100%);padding:25px;border-radius:16px;text-align:center;border:1px solid #e2e8f0;transition:transform .3s ease;position:relative;color:#1e293b}.info-button{position:absolute;top:10px;right:10px;width:24px;height:24px;border-radius:50%;background:#4f46e5;color:#fff;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;transition:all .3s ease;box-shadow:0 2px 4px rgba(79,70,229,.3)}.info-button:hover{background:#3730a3;transform:scale(1.1)}.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);backdrop-filter:blur(5px)}.modal-content{background-color:#fff;margin:10% auto;padding:30px;border-radius:20px;width:90%;max-width:500px;position:relative;box-shadow:0 20px 40px rgba(0,0,0,.2);animation:modalSlideIn .3s ease-out}@keyframes modalSlideIn{0%{opacity:0;transform:translateY(-50px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:15px;border-bottom:2px solid #e2e8f0}.modal-header h3{color:#1e293b;font-size:1.3rem;margin:0}.close-modal{background:0 0;border:none;font-size:24px;cursor:pointer;color:#64748b;padding:0;width:30px;height:30px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.close-modal:hover{background:#f1f5f9;color:#1e293b}.modal-body{color:#374151;line-height:1.6}.calculation-formula{background:#f8fafc;padding:15px;border-radius:10px;border-left:4px solid #4f46e5;margin:15px 0;font-family:monospace;font-weight:700;color:#1e293b}.example-box{background:#ecfdf5;padding:15px;border-radius:10px;border-left:4px solid #10b981;margin:15px 0;font-size:.95rem;line-height:1.8}.example-box strong{color:#065f46}.metric-card:hover{transform:translateY(-2px)}.metric-value{font-size:2.2rem;font-weight:700;color:#1e293b;margin-bottom:8px}.metric-label{font-size:.9rem;color:#374151;font-weight:500}.savings-highlight{color:#fff;padding:30px;border-radius:16px;text-align:center;margin-bottom:30px;box-shadow:0 10px 25px rgba(16,185,129,.3)}.savings-highlight h3{font-size:1.3rem;margin-bottom:10px}.savings-highlight .amount{font-size:3rem;font-weight:700;margin-bottom:5px}.cost-method-note{margin-top:15px;font-size:.85rem;opacity:.9;background:rgba(255,255,255,.1);padding:10px 15px;border-radius:8px}.chart-container{height:300px;margin-top:20px}.hidden{display:none}.comparison-table{width:100%;border-collapse:collapse;margin-top:20px;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 6px rgba(0,0,0,.05)}.comparison-table th,.comparison-table td{padding:15px;text-align:left;border-bottom:1px solid #e2e8f0}.comparison-table td{color:#374151}.comparison-table th{background:#e5e7eb;font-weight:600;color:#374151}.export-btn{margin-top:20px;padding:12px 24px;background:#6b7280;color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500;transition:background .3s ease}.export-btn:hover{background:#4b5563}@media (max-width:768px){.main-content{grid-template-columns:1fr}.input-section{border-right:none;border-bottom:1px solid #e2e8f0}.results-grid{grid-template-columns:1fr}.header h1{font-size:2rem}}</style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Lumen5 ROI Calculator</h1>
            <p>Calculate your video post-production time and cost savings</p>
            <p style="font-size: 0.9rem; margin-top: 10px; opacity: 0.8;">Transform weeks of editing and revision cycles into hours with AI-powered video creation</p>
        </header>
        
        <main class="main-content">
            <div class="input-section">
                <div class="form-group">
                    <label for="videoCount">Number of Videos Created</label>
                    <input type="number" id="videoCount" placeholder="e.g., 20" min="1" value="20">
                </div>
                <div class="form-group">
                    <label for="timeFrame">Time Period (months)</label>
                    <input type="number" id="timeFrame" placeholder="e.g., 1" min="1" max="12" value="1">
                </div>
                <div class="form-group">
                    <label for="lumenPlan">Your Lumen5 Plan</label>
                    <select id="lumenPlan" disabled>
                        <option value="enterprise" selected>Enterprise (Custom)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="enterpriseCost">Annual Enterprise Cost</label>
                    <input type="number" id="enterpriseCost" placeholder="e.g., 15000" min="0" step="1000" value="12000">
                </div>
                <div class="form-group">
                    <label for="costMethod">How do you calculate traditional post-production costs?</label>
                    <select id="costMethod">
                        <option value="direct">Direct cost per video</option>
                        <option value="hourly">Hourly rate × Time</option>
                    </select>
                </div>
                <div class="form-group" id="traditionalCostGroup">
                    <label for="traditionalCost">Traditional Video Post-Production Cost per Video</label>
                    <input type="number" id="traditionalCost" placeholder="e.g., 800" min="0" step="50" value="800">
                    <small>Typical cost for editing, revisions, and final delivery</small>
                </div>
                <div class="form-group" id="hourlyRateGroup" style="display: none;">
                    <label for="traditionalHourlyRate">Traditional Post-Production Hourly Rate</label>
                    <select id="traditionalHourlyRate">
                        <option value="75">Freelance Video Editor ($75/hr)</option>
                        <option value="100" selected>Professional Video Editor ($100/hr)</option>
                        <option value="150">Video Production Agency ($150/hr)</option>
                        <option value="200">Premium Post-Production Studio ($200/hr)</option>
                        <option value="custom">Custom Hourly Rate</option>
                    </select>
                </div>
                <div class="form-group" id="customRateGroup" style="display: none;">
                    <label for="customRate">Custom Hourly Rate ($)</label>
                    <input type="number" id="customRate" placeholder="e.g., 125" min="0" step="25" value="100">
                </div>
                <div class="form-group">
                    <label for="traditionalTime">Traditional Production Time (hours per video)</label>
                    <input type="number" id="traditionalTime" placeholder="e.g., 8" min="0" step="0.5" value="6">
                </div>
                <div class="form-group">
                    <label for="lumenTime">Lumen5 Creation Time (minutes per video)</label>
                    <input type="number" id="lumenTime" placeholder="e.g., 90" min="0" step="15" value="90">
                    <small>Includes AI-powered creation (30 min) + minimal review/coordination (60 min)</small>
                </div>
                <div class="form-group">
                    <label for="hourlyWage">Production Coordination Wage</label>
                    <select id="hourlyWage">
                        <option value="40">Marketing Coordinator ($40/hr)</option>
                        <option value="50" selected>Marketing Specialist ($50/hr)</option>
                        <option value="65">Marketing Manager ($65/hr)</option>
                        <option value="85">Senior Marketing Manager ($85/hr)</option>
                        <option value="100">Director of Marketing ($100/hr)</option>
                        <option value="custom">Custom Production Wage</option>
                    </select>
                </div>
                <div class="form-group" id="customWageGroup" style="display: none;">
                    <label for="customWage">Custom Production Wage ($)</label>
                    <input type="number" id="customWage" placeholder="e.g., 65" min="0" step="5" value="50">
                </div>
                <button class="calculate-btn">Calculate My Savings</button>
            </div>
            
            <div class="results-section">
                <div id="results" class="hidden">
                    <h2 style="margin-bottom: 30px; color: #1e293b;">Your ROI Analysis</h2>
                    <p style="margin-bottom: 20px; color: #64748b; font-size: 0.95rem;">Based on post-production time and cost savings with AI-powered video creation</p>
                    <div class="savings-highlight">
                        <h3>Total Value Created</h3>
                        <div class="amount" id="totalSavings">$0</div>
                        <p>Cost savings + Time value saved</p>
                        <p style="font-size: 0.9rem; margin-top: 10px; opacity: 0.9;">Plus: Project timelines compressed from weeks to hours</p>
                        <div id="costMethodNote" class="cost-method-note" style="display: none;">
                            <strong>Cost Method:</strong> <span id="costMethodText"></span>
                        </div>
                    </div>
                    <div class="results-grid">
                        <div class="metric-card"><button class="info-button" data-modal="timeSaved">i</button><div class="metric-value" id="timeSaved">0h</div><div class="metric-label">Post-Production Time Saved</div></div>
                        <div class="metric-card"><button class="info-button" data-modal="timeValue">i</button><div class="metric-value" id="timeValue">$0</div><div class="metric-label">Coordination Time Value</div></div>
                        <div class="metric-card"><button class="info-button" data-modal="roi">i</button><div class="metric-value" id="roiPercentage">0%</div><div class="metric-label">Total ROI</div></div>
                        <div class="metric-card"><button class="info-button" data-modal="productivity">i</button><div class="metric-value" id="productivityGain">0x</div><div class="metric-label">Post-Production Speed</div></div>
                    </div>
                    <div class="results-grid">
                        <div class="metric-card"><button class="info-button" data-modal="savingsPerVideo">i</button><div class="metric-value" id="savingsPerVideo">$0</div><div class="metric-label">Total Savings per Video</div></div>
                        <div class="metric-card"><button class="info-button" data-modal="costROI">i</button><div class="metric-value" id="costROI">0%</div><div class="metric-label">Post-Production Cost ROI</div></div>
                        <div class="metric-card"><button class="info-button" data-modal="totalValue">i</button><div class="metric-value" id="totalValue">$0</div><div class="metric-label">Total Value Created</div></div>
                        <div class="metric-card"><button class="info-button" data-modal="breakeven">i</button><div class="metric-value" id="breakeven">0</div><div class="metric-label">Videos to Break Even</div></div>
                    </div>
                    <table class="comparison-table">
                        <thead><tr><th>Metric</th><th>Traditional Post-Production</th><th>Lumen5</th><th>Difference</th></tr></thead>
                        <tbody id="comparisonTableBody"></tbody>
                    </table>
                    <div class="chart-container"><canvas id="savingsChart"></canvas></div>
                </div>
                <div id="placeholder" style="text-align: center; padding: 100px 20px; color: #64748b;">
                    <h3>Enter your data to see results</h3>
                    <p>Fill out the form on the left to calculate your video post-production savings</p>
                </div>
            </div>
        </main>
    </div>

    <div id="calculationModal" class="modal">
        <div class="modal-content">
            <header class="modal-header">
                <h3 id="modalTitle">Calculation Details</h3>
                <button class="close-modal">&times;</button>
            </header>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const getEl = (id) => document.getElementById(id);
        const ui = {
            inputs: {
                videoCount: getEl("videoCount"), timeFrame: getEl("timeFrame"), enterpriseCost: getEl("enterpriseCost"),
                costMethod: getEl("costMethod"), traditionalCost: getEl("traditionalCost"), traditionalHourlyRate: getEl("traditionalHourlyRate"),
                customRate: getEl("customRate"), traditionalTime: getEl("traditionalTime"), lumenTime: getEl("lumenTime"),
                hourlyWage: getEl("hourlyWage"), customWage: getEl("customWage"),
            },
            groups: {
                traditionalCost: getEl("traditionalCostGroup"), hourlyRate: getEl("hourlyRateGroup"),
                customRate: getEl("customRateGroup"), customWage: getEl("customWageGroup"),
            },
            results: {
                container: getEl("results"), placeholder: getEl("placeholder"), totalSavings: getEl("totalSavings"),
                timeSaved: getEl("timeSaved"), timeValue: getEl("timeValue"), roiPercentage: getEl("roiPercentage"),
                productivityGain: getEl("productivityGain"), savingsPerVideo: getEl("savingsPerVideo"),
                costROI: getEl("costROI"), totalValue: getEl("totalValue"), breakeven: getEl("breakeven"),
                costMethodNote: getEl("costMethodNote"), costMethodText: getEl("costMethodText"),
                savingsHighlight: document.querySelector('.savings-highlight'),
                comparisonTableBody: getEl("comparisonTableBody"),
                savingsChartCanvas: getEl("savingsChart"),
            },
            modal: {
                el: getEl("calculationModal"), title: getEl("modalTitle"), body: getEl("modalBody"),
                closeBtn: document.querySelector(".close-modal"),
            },
            buttons: {
                calculate: document.querySelector(".calculate-btn"), export: document.querySelector(".export-btn"),
            }
        };

        let state = {};
        let savingsChart = null;

        const $ = (v) => parseFloat(v) || 0;
        const formatC = (v) => `$${Math.round(v).toLocaleString()}`;
        const formatH = (v, d = 0) => `${$(v).toFixed(d)} hours`;

        const calculate = () => {
            const i = ui.inputs;
            const videoCount = $(i.videoCount.value);
            if (videoCount === 0) { alert("Please enter the number of videos created."); return false; }

            const timeFrameMonths = $(i.timeFrame.value) || 1;
            const traditionalTime = $(i.traditionalTime.value);
            const lumenTime = $(i.lumenTime.value) / 60;
            const annualEnterpriseCost = $(i.enterpriseCost.value);
            const lumenCostForPeriod = (annualEnterpriseCost / 12) * timeFrameMonths;

            const hourlyRate = i.traditionalHourlyRate.value === 'custom' ? $(i.customRate.value) : $(i.traditionalHourlyRate.value);
            const traditionalCostPerVideo = i.costMethod.value === 'direct' ? $(i.traditionalCost.value) : hourlyRate * traditionalTime;
            
            const hourlyWage = i.hourlyWage.value === 'custom' ? $(i.customWage.value) : $(i.hourlyWage.value);

            const totalTraditionalCost = videoCount * traditionalCostPerVideo;
            const totalCostSavings = totalTraditionalCost - lumenCostForPeriod;
            
            const coordTimeSavedPerVideo = (traditionalTime * 0.6) - (lumenTime * 0.67);
            const totalCoordTimeSaved = videoCount * coordTimeSavedPerVideo;
            const timeValueSaved = totalCoordTimeSaved * hourlyWage;
            
            const totalValueCreated = totalCostSavings + timeValueSaved;
            const savingsPerVideo = videoCount > 0 ? totalValueCreated / videoCount : 0;
            const totalROI = lumenCostForPeriod > 0 ? (totalValueCreated / lumenCostForPeriod) * 100 : 0;
            
            state = {
                inputs: {
                    videoCount, timeFrameMonths, traditionalTime, lumenTime, traditionalCostPerVideo,
                    hourlyRate: i.traditionalHourlyRate.value === 'custom' ? $(i.customRate.value) : $(i.traditionalHourlyRate.value),
                    hourlyWage, annualEnterpriseCost
                },
                results: {
                    lumenCostForPeriod, totalTraditionalCost, totalCostSavings,
                    totalTimeSaved: videoCount * (traditionalTime - lumenTime),
                    coordTimeSavedPerVideo, totalCoordTimeSaved, timeValueSaved,
                    totalValueCreated, savingsPerVideo,
                    costOnlyROI: lumenCostForPeriod > 0 ? (totalCostSavings / lumenCostForPeriod) * 100 : 0,
                    totalROI,
                    productivityGain: lumenTime > 0 ? traditionalTime / lumenTime : 0,
                    breakEvenVideos: savingsPerVideo > 0 ? lumenCostForPeriod / savingsPerVideo : Infinity,
                }
            };
            return true;
        };
        
        const render = () => {
            const { results: r, inputs: i } = state;
            const resUI = ui.results;
            
            resUI.totalSavings.textContent = `${r.totalValueCreated >= 0 ? '$' : '-$'}${Math.abs(Math.round(r.totalValueCreated)).toLocaleString()}`;
            resUI.timeSaved.textContent = `${Math.round(r.totalTimeSaved)}h`;
            resUI.timeValue.textContent = formatC(Math.max(0, r.timeValueSaved));
            resUI.roiPercentage.textContent = `${Math.round(r.totalROI)}%`;
            resUI.savingsPerVideo.textContent = `${r.savingsPerVideo >= 0 ? '$' : '-$'}${Math.abs(Math.round(r.savingsPerVideo))}`;
            resUI.costROI.textContent = `${Math.round(r.costOnlyROI)}%`;
            resUI.totalValue.textContent = resUI.totalSavings.textContent;
            resUI.breakeven.textContent = r.breakEvenVideos !== Infinity ? r.breakEvenVideos.toFixed(1) : "N/A";
            resUI.productivityGain.textContent = r.productivityGain > 100 ? "100+x" : `${r.productivityGain.toFixed(1)}x`;
            
            const videosPerMonth = i.videoCount / i.timeFrameMonths;
            const annualVideos = videosPerMonth * 12;
            const annualTradCost = annualVideos * i.traditionalCostPerVideo;
            if (ui.inputs.costMethod.value === "direct") {
                resUI.costMethodText.textContent = `Post-production: ${formatC(i.traditionalCostPerVideo)}/video × ${annualVideos.toFixed(0)} videos/year = ${formatC(annualTradCost)} annual cost`;
            } else {
                resUI.costMethodText.textContent = `Post-production: $${i.hourlyRate}/hr × ${i.traditionalTime} hrs = ${formatC(i.traditionalCostPerVideo)}/video × ${annualVideos.toFixed(0)} videos/year = ${formatC(annualTradCost)} annual cost`;
            }
            resUI.costMethodNote.style.display = "block";
            
            const sh = resUI.savingsHighlight;
            sh.style.background = r.totalValueCreated >= 0 ? 'linear-gradient(135deg, #10b981 0%, #059669 100%)' : 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
            sh.querySelector('h3').textContent = r.totalValueCreated >= 0 ? 'Total Value Created' : 'Net Cost';
            sh.querySelector('p').textContent = r.totalValueCreated >= 0 ? 'Cost savings + Time value saved' : 'Create more videos to achieve positive ROI';
            sh.querySelectorAll('p')[1].style.display = r.totalValueCreated >= 0 ? 'block' : 'none';
            
            renderTable();
            renderChart();
            
            resUI.placeholder.classList.add("hidden");
            resUI.container.classList.remove("hidden");
        };
        
        const renderTable = () => {
            const { results: r, inputs: i } = state;
            const tradCoordTimeValue = (i.traditionalTime * 0.6 * i.hourlyWage) * i.videoCount;
            const lumenCoordTimeValue = (i.lumenTime * 0.67 * i.hourlyWage) * i.videoCount;

            const createRow = (label, tVal, lVal, dVal, dStyle, dPrefix, dSuffix="") => `<tr><td><strong>${label}</strong></td><td>${tVal}</td><td>${lVal}</td><td style="color:${dStyle};"><strong>${dPrefix}${dVal}${dSuffix}</strong></td></tr>`;

            const rows = [
                { l: "Post-Production Costs", t: formatC(r.totalTraditionalCost), l: formatC(r.lumenCostForPeriod), d: r.totalCostSavings, p: r.totalCostSavings >= 0 ? '-$' : '+$' },
                { l: "Coordination Time Value", t: formatC(tradCoordTimeValue), l: formatC(lumenCoordTimeValue), d: r.timeValueSaved, p: r.timeValueSaved >= 0 ? '-$' : '+$' },
                { l: "Total Post-Production Time", t: formatH(r.totalTimeSaved + i.lumenTime * i.videoCount), l: formatH(i.lumenTime * i.videoCount), d: r.totalTimeSaved, p: '-', s: ' hours' },
                { l: "Coordination Hours", t: formatH(i.traditionalTime * 0.6 * i.videoCount, 1), l: formatH(i.lumenTime * 0.67 * i.videoCount, 1), d: r.totalCoordTimeSaved, p: '-', s: ' hours' },
            ];

            ui.results.comparisonTableBody.innerHTML = rows.map(row => createRow(row.l, row.t, row.l, Math.abs(Math.round(row.d)).toLocaleString(), row.d >= 0 ? '#10b981' : '#ef4444', row.p, row.s)).join('');
        };
        
        const renderChart = () => {
            const { results: r, inputs: i } = state;
            const videosPerMonth = i.videoCount / i.timeFrameMonths;
            const monthlyLumenCost = i.annualEnterpriseCost / 12;
            const monthlyCostSavings = (videosPerMonth * i.traditionalCostPerVideo) - monthlyLumenCost;

            const data = { labels: [], datasets: [ { data: [] }, { data: [] }, { data: [] }, { data: [] } ] };
            for (let m = 1; m <= 12; m++) {
                data.labels.push(`Month ${m}`);
                const totalVideos = videosPerMonth * m;
                const costSavings = monthlyCostSavings * m;
                const timeSavings = r.coordTimeSavedPerVideo * totalVideos * i.hourlyWage;
                data.datasets[0].data.push(costSavings + timeSavings);
                data.datasets[1].data.push(costSavings);
                data.datasets[2].data.push(timeSavings);
                data.datasets[3].data.push(monthlyLumenCost * m);
            }
            
            if (savingsChart) savingsChart.destroy();
            savingsChart = new Chart(ui.results.savingsChartCanvas.getContext("2d"), {
                type: "line",
                data: {
                    labels: data.labels,
                    datasets: [
                        { label: "Total Value Created", data: data.datasets[0].data, borderColor: "#10b981", backgroundColor: "rgba(16,185,129,.1)", tension: 0.4, fill: true },
                        { label: "Cost Savings Only", data: data.datasets[1].data, borderColor: "#3b82f6", tension: 0.4 },
                        { label: "Time Value Saved", data: data.datasets[2].data, borderColor: "#8b5cf6", tension: 0.4 },
                        { label: "Lumen5 Investment", data: data.datasets[3].data, borderColor: "#ef4444", tension: 0.4 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: "top" }, title: { display: true, text: `12-Month Savings Projection (${videosPerMonth.toFixed(1)} videos/month)` } },
                    scales: { y: { ticks: { callback: (v) => formatC(v).replace('$-', '-$') } } }
                }
            });
        };
        
        const getModalContent = (type) => {
            const { results: r, inputs: i } = state;
            const c = (v) => Math.abs(Math.round(v)).toLocaleString();
            const s = (v) => v >= 0 ? '$' : '-$';
            const modalMap = {
                timeSaved: {
                    title: "Time Saved Calculation",
                    html: `<p>Hours saved using Lumen5 instead of traditional post-production workflows.</p>
                           <div class='calculation-formula'>(Traditional Time - Lumen5 Time) × Videos</div>
                           <div class='example-box'><strong>Your Calculation:</strong><br>(${i.traditionalTime}h traditional - ${i.lumenTime.toFixed(1)}h with Lumen5) × ${i.videoCount} videos = <strong>${Math.round(r.totalTimeSaved)} hours saved</strong></div>`
                },
                timeValue: {
                    title: "Coordination Time Value Saved",
                    html: `<p>Monetary value of coordination time freed up from managing post-production.</p>
                           <div class='calculation-formula'>Coordination Time Saved × Coordination Wage</div>
                           <div class='example-box'><strong>Your Calculation:</strong><br>${r.totalCoordTimeSaved.toFixed(1)} hours saved × ${i.hourlyWage}/hour (your coordination wage) = <strong>${formatC(r.timeValueSaved)} saved</strong></div>`
                },
                roi: {
                    title: "Total Return on Investment (ROI)",
                    html: `<p>Complete financial return, including direct cost savings and time value.</p>
                           <div class='calculation-formula'>(Total Value ÷ Lumen5 Cost) × 100</div>
                           <div class='example-box'><strong>Your Calculation:</strong><br>(${formatC(r.totalValueCreated)} total value created ÷ ${formatC(r.lumenCostForPeriod)} from your Lumen5 plan) × 100 = <strong>${Math.round(r.totalROI)}% Total ROI</strong></div>`
                },
                productivity: {
                    title: "Post-Production Speed",
                    html: `<p>How much faster you can complete video projects with Lumen5.</p>
                           <div class='calculation-formula'>Traditional Time ÷ Lumen5 Time</div>
                           <div class='example-box'><strong>Your Calculation:</strong><br>${i.traditionalTime}h (traditional time) ÷ ${i.lumenTime.toFixed(1)}h (Lumen5 time) = <strong>${r.productivityGain > 100 ? "100+" : r.productivityGain.toFixed(1)}x faster</strong></div>`
                },
                savingsPerVideo: {
                    title: "Total Savings per Video",
                    html: `<p>Complete value (cost + time) saved on each video by using Lumen5.</p>
                           <div class='calculation-formula'>Total Value Created ÷ Number of Videos</div>
                           <div class='example-box'><strong>Your Calculation:</strong><br>${s(r.totalValueCreated)}${c(r.totalValueCreated)} (total value) ÷ ${i.videoCount} videos created = <strong>${s(r.savingsPerVideo)}${c(r.savingsPerVideo)} per video</strong></div>`
                },
                costROI: {
                    title: "Post-Production Cost ROI",
                    html: `<p>ROI based only on direct post-production cost savings.</p>
                           <div class='calculation-formula'>(Cost Savings ÷ Lumen5 Cost) × 100</div>
                           <div class='example-box'><strong>Your Calculation:</strong><br>(${s(r.totalCostSavings)}${c(r.totalCostSavings)} cost savings ÷ ${formatC(r.lumenCostForPeriod)} from your Lumen5 plan) × 100 = <strong>${Math.round(r.costOnlyROI)}% Cost ROI</strong></div>`
                },
                totalValue: {
                    title: "Total Value Created",
                    html: `<p>Complete economic value generated by using Lumen5.</p>
                           <div class='calculation-formula'>Cost Savings + Time Value Saved</div>
                           <div class='example-box'><strong>Your Calculation:</strong><br>${s(r.totalCostSavings)}${c(r.totalCostSavings)} (post-production cost savings) + ${formatC(r.timeValueSaved)} (coordination time value) = <strong>${s(r.totalValueCreated)}${c(r.totalValueCreated)}</strong></div>`
                },
                breakeven: {
                    title: "Videos to Break Even",
                    html: `<p>Number of videos needed to pay for your Lumen5 subscription through savings.</p>
                           <div class='calculation-formula'>Lumen5 Cost ÷ Savings per Video</div>
                           <div class='example-box'><strong>Your Calculation:</strong><br>${formatC(r.lumenCostForPeriod)} (your Lumen5 plan cost for ${i.timeFrameMonths} month${i.timeFrameMonths > 1 ? 's' : ''}) ÷ ${s(r.savingsPerVideo)}${c(r.savingsPerVideo)} per video = <strong>${r.breakEvenVideos.toFixed(1)} videos</strong></div>`
                },
            };
            return modalMap[type];
        };

        const showModal = (type) => {
            const content = getModalContent(type);
            if (!content) return;
            ui.modal.title.textContent = content.title;
            ui.modal.body.innerHTML = content.html;
            ui.modal.el.style.display = "block";
            document.body.style.overflow = "hidden";
        };

        const closeModal = () => {
            ui.modal.el.style.display = "none";
            document.body.style.overflow = "auto";
        };

        const exportResults = () => {
            const { results: r, inputs: i } = state;
            const iUI = ui.inputs;
            const tradCostDetail = ui.inputs.costMethod.value === 'direct' ? formatC(i.traditionalCostPerVideo) : `${formatC(i.traditionalCostPerVideo)} (from $${i.hourlyRate}/hr)`;
            const report = `LUMEN5 POST-PRODUCTION ROI ANALYSIS REPORT
Generated: ${new Date().toLocaleString()}
=====================================

INPUT PARAMETERS
Number of Videos: ${i.videoCount}
Time Frame: ${i.timeFrameMonths} month(s)
Traditional Cost per Video: ${tradCostDetail}
Traditional Time per Video: ${i.traditionalTime} hours
Lumen5 Time per Video: ${i.lumenTime * 60} minutes
Lumen5 Plan: Enterprise (${formatC(i.annualEnterpriseCost)}/year)

ROI RESULTS
=====================================
Total Value Created: ${ui.results.totalSavings.textContent}
Time Saved: ${ui.results.timeSaved.textContent}
Coordination Time Value Saved: ${ui.results.timeValue.textContent}
Total ROI: ${ui.results.roiPercentage.textContent}
Cost-Only ROI: ${ui.results.costROI.textContent}
Savings per Video: ${ui.results.savingsPerVideo.textContent}
Productivity Gain: ${ui.results.productivityGain.textContent}
Videos to Break Even: ${ui.results.breakeven.textContent}`;

            try {
                if (navigator.clipboard?.writeText) {
                    navigator.clipboard.writeText(report).then(() => alert("ROI Report copied to clipboard!"));
                } else {
                    throw new Error("Clipboard API not available");
                }
            } catch (e) {
                const modalHTML = `<div style="white-space: pre-wrap; font-family: monospace; background: #f5f5f5; padding: 20px; border-radius: 8px; max-height: 400px; overflow-y: auto;">${report.replace(/</g, '&lt;')}</div><p style="margin-top:15px;">Please copy the text above (Ctrl+A, Ctrl+C).</p>`;
                ui.modal.title.textContent = "Export ROI Report";
                ui.modal.body.innerHTML = modalHTML;
                ui.modal.el.style.display = "block";
                document.body.style.overflow = "hidden";
            }
        };
        
        const handleCalculate = () => {
            if (calculate()) render();
        };

        // Event Listeners
        ui.buttons.calculate.addEventListener('click', handleCalculate);
        ui.modal.closeBtn.addEventListener('click', closeModal);
        window.addEventListener('click', (e) => { if (e.target === ui.modal.el) closeModal(); });

        document.querySelectorAll('.info-button').forEach(btn => {
            btn.addEventListener('click', () => showModal(btn.dataset.modal));
        });

        ui.inputs.costMethod.addEventListener('change', () => {
            const isDirect = ui.inputs.costMethod.value === 'direct';
            ui.groups.traditionalCost.style.display = isDirect ? 'block' : 'none';
            ui.groups.hourlyRate.style.display = isDirect ? 'none' : 'block';
            if (!isDirect) ui.inputs.traditionalHourlyRate.dispatchEvent(new Event('change'));
        });

        const toggleCustomInput = (select, group) => { group.style.display = select.value === 'custom' ? 'block' : 'none'; };
        ui.inputs.traditionalHourlyRate.addEventListener('change', () => toggleCustomInput(ui.inputs.traditionalHourlyRate, ui.groups.customRate));
        ui.inputs.hourlyWage.addEventListener('change', () => toggleCustomInput(ui.inputs.hourlyWage, ui.groups.customWage));
        
        // Initial Calculation
        handleCalculate();
        ui.inputs.videoCount.focus();
    });
    </script>
</body>
</html>